  /// \file CaloHitNeighborSearchHelper.h
/*
 *
 * CaloHitNeighborSearchHelper.h header template automatically generated by a class generator
 * Creation date : lun. mars 30 2015
 *
 * This file is part of ArborContent libraries.
 * 
 * ArborContent is free software: you can redistribute it and/or modify
 * it under the terms of the GNU General Public License as published by
 * the Free Software Foundation, either version 3 of the License, or
 * (at your option) any later version.
 * based upon these libraries are permitted. Any copy of these libraries
 * must include this copyright notice.
 * 
 * ArborContent is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU General Public License for more details.
 * 
 * You should have received a copy of the GNU General Public License
 * along with ArborContent.  If not, see <http://www.gnu.org/licenses/>.
 * 
 * @author Remi Ete
 * @copyright CNRS , IPNL
 */


#ifndef CALOHITNEIGHBORSEARCHHELPER_H
#define CALOHITNEIGHBORSEARCHHELPER_H

#include "Pandora/PandoraInternal.h"
#include "Pandora/StatusCodes.h"

#include "ArborObjects/CaloHit.h"
#include "ArborObjects/Connector.h"

#include <mlpack/core.hpp>
#include <mlpack/core/math/range.hpp>
#include <mlpack/methods/neighbor_search/neighbor_search.hpp>

namespace pandora { class Algorithm; class CaloHit; class Track; }

namespace arbor_content
{

/** 
 * @brief CaloHitNeighborSearchHelper class
 */ 
class CaloHitNeighborSearchHelper 
{
public:
	// build 
    static pandora::StatusCode BuildNeighborSearch(const pandora::CaloHitList *const pCaloHitList);
	
    // search 
    static pandora::StatusCode SearchNeighbourHits(pandora::CartesianVector testPosition, int nNeighbor, pandora::CaloHitList& hitsInRange);

private:

    static pandora::StatusCode FillMatixFromCaloHits(const pandora::CaloHitVector& caloHitVector, arma::mat& caloHitsMatrix);

	static arma::mat m_caloHitsMatrix;

	// all hits
	static const pandora::CaloHitList* m_pCaloHitList;

	//-----------------
	static pandora::CaloHitVector m_caloHitVector;

	static mlpack::neighbor::KNN m_neighborSearch;
};

} 

#endif  
